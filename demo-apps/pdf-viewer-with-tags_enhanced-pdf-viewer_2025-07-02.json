{
  "id": "enhanced-pdf-viewer",
  "title": "Enhanced PDF Viewer with Custom Tags",
  "icon": "ðŸ“„",
  "type": "user",
  "customRequest": "Enhanced PDF Viewer with Custom Tags - Upload a PDF with optional supplemental markdown file using [TEXT] and [VIDEO] tags",
  "html": "<div style=\"font-family: Arial, sans-serif; height: 100%; display: flex; flex-direction: column; background-color: #f0f0f0;\"><div id=\"enhanced-pdf-viewer_header\" style=\"text-align: center; padding: 15px; background: white; border-bottom: 1px solid #ddd;\"><h2 style=\"margin: 0 0 10px 0; color: #333;\">Enhanced PDF Viewer with Custom Tags</h2><p style=\"margin: 0; color: #666; font-size: 14px;\">Upload a PDF with optional supplemental markdown file using [TEXT] and [VIDEO] tags.</p></div><div id=\"enhanced-pdf-viewer_upload\" style=\"background: white; padding: 20px; margin: 10px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\"><div style=\"margin-bottom: 15px;\"><label style=\"display: block; margin-bottom: 5px; font-weight: bold;\">PDF File:</label><input type=\"file\" id=\"enhanced-pdf-viewer_file-upload\" accept=\"application/pdf\" style=\"width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;\"></div><div style=\"margin-bottom: 15px;\"><label style=\"display: block; margin-bottom: 5px; font-weight: bold;\">Supplemental Markdown File (Optional):</label><input type=\"file\" id=\"enhanced-pdf-viewer_supplemental-upload\" accept=\".md,.txt\" style=\"width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;\"></div><button id=\"enhanced-pdf-viewer_upload-button\" style=\"background: #4CAF50; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; font-size: 16px;\">View Files</button><div id=\"enhanced-pdf-viewer_loading\" style=\"display: none; color: #666; margin-top: 10px;\">Loading PDF...</div></div><div style=\"display: flex; flex: 1; gap: 20px; margin: 0 10px 10px 10px; min-height: 0; overflow: hidden;\"><div id=\"enhanced-pdf-viewer_pdf-container\" style=\"flex: 1; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); display: none; position: relative; min-height: 0; display: flex; flex-direction: column;\"><div id=\"enhanced-pdf-viewer_pdf-viewer\" style=\"width: 100%; border: 1px solid #ddd; overflow: hidden; cursor: pointer; flex: 1; display: flex; justify-content: center; align-items: center; min-height: 300px;\"><canvas id=\"enhanced-pdf-viewer_pdf-canvas\" style=\"max-width: 100%; max-height: 100%;\"></canvas></div><div id=\"enhanced-pdf-viewer_navigation\" style=\"display: flex; justify-content: space-between; margin-top: 15px; align-items: center; flex-shrink: 0;\"><button id=\"enhanced-pdf-viewer_prev-page\" style=\"background: #2196F3; color: white; padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer;\">Previous</button><div style=\"display: flex; align-items: center; gap: 15px;\"><span>Page <span id=\"enhanced-pdf-viewer_current-page\">1</span> of <span id=\"enhanced-pdf-viewer_total-pages\">1</span></span><button id=\"enhanced-pdf-viewer_maximize-button\" style=\"background: #ff9800; color: white; padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer;\">Maximize</button></div><button id=\"enhanced-pdf-viewer_next-page\" style=\"background: #2196F3; color: white; padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer;\">Next</button></div></div><div id=\"enhanced-pdf-viewer_supplemental-container\" style=\"flex-basis: 350px; flex-shrink: 0; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); display: none;\"><h3 style=\"margin-top: 0;\">Supplemental Info</h3><div id=\"enhanced-pdf-viewer_supplemental-content\"><p>No supplemental information for this page.</p></div></div></div><div id=\"enhanced-pdf-viewer_maximized-panel\" style=\"position: fixed; bottom: 20px; right: 20px; z-index: 10000; display: none; flex-direction: column; gap: 10px;\"></div><div id=\"enhanced-pdf-viewer_text-modal\" style=\"display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8); z-index: 10001; justify-content: center; align-items: center;\"><div style=\"width: 90%; max-width: 800px; max-height: 90vh; background: white; border-radius: 10px; overflow: hidden; position: relative; display: flex; flex-direction: column;\"><div style=\"padding: 15px 20px; border-bottom: 1px solid #ddd; display: flex; justify-content: space-between; align-items: center;\"><div id=\"enhanced-pdf-viewer_text-modal-title\" style=\"font-size: 1.2em; font-weight: bold;\">Text Content</div></div><div style=\"padding: 20px; overflow-y: auto; flex-grow: 1;\"><pre id=\"enhanced-pdf-viewer_text-modal-content\" style=\"white-space: pre-wrap; word-wrap: break-word; background: #f5f5f5; padding: 15px; border-radius: 5px; margin: 0;\"></pre></div><div style=\"padding: 10px 20px; border-top: 1px solid #ddd; text-align: right;\"><button id=\"enhanced-pdf-viewer_text-modal-copy\" style=\"background: #2196F3; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; margin-right: 10px;\">Copy</button><button id=\"enhanced-pdf-viewer_text-modal-close\" style=\"background: #f44336; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer;\">Close</button></div></div></div></div>",
  "css": "#content_enhanced-pdf-viewer .enhanced-pdf-viewer__supplemental-button { background: #E91E63; color: white; padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; width: 100%; text-align: left; margin-bottom: 10px; } #content_enhanced-pdf-viewer .enhanced-pdf-viewer__supplemental-button:hover { background: #C2185B; } #content_enhanced-pdf-viewer .enhanced-pdf-viewer__maximized-button { background: #E91E63; color: white; padding: 12px 18px; border: none; border-radius: 8px; cursor: pointer; font-size: 14px; min-width: 120px; text-align: center; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3); transition: all 0.2s ease; } #content_enhanced-pdf-viewer .enhanced-pdf-viewer__maximized-button:hover { background: #C2185B; transform: translateY(-2px); box-shadow: 0 6px 16px rgba(0, 0, 0, 0.4); } #content_enhanced-pdf-viewer .enhanced-pdf-viewer__maximized { position: fixed !important; top: 0 !important; left: 0 !important; right: 0 !important; bottom: 0 !important; width: 100% !important; height: 100vh !important; z-index: 9999 !important; background: black !important; padding: 0 !important; margin: 0 !important; border-radius: 0 !important; box-shadow: none !important; } #content_enhanced-pdf-viewer .enhanced-pdf-viewer__maximized #enhanced-pdf-viewer_pdf-viewer { height: 100vh !important; border: none !important; background: black !important; } #content_enhanced-pdf-viewer .enhanced-pdf-viewer__maximized #enhanced-pdf-viewer_navigation { display: none !important; } #content_enhanced-pdf-viewer .enhanced-pdf-viewer__hidden { display: none !important; } #content_enhanced-pdf-viewer { color: inherit; background: inherit; } .app-light-theme #content_enhanced-pdf-viewer { background: #ffffff; color: #212529; } .app-dark-theme #content_enhanced-pdf-viewer { background: #2c3e50; color: #f8f9fa; }",
  "javascript": "if (typeof pdfjsLib === 'undefined') { const script = document.createElement('script'); script.src = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js'; document.head.appendChild(script); script.onload = function() { pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.worker.min.js'; }; } else { pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.worker.min.js'; } let pdfDoc = null; let pageNum = 1; let pageRendering = false; let pageNumPending = null; let scale = 1.5; let canvas, ctx; let supplementalData = {}; let hasSupplementalFile = false; let isMaximized = false; function initializePDFViewer() { canvas = document.getElementById('enhanced-pdf-viewer_pdf-canvas'); if (canvas) { ctx = canvas.getContext('2d'); } } async function parseMarkdownFile(file) { return new Promise((resolve, reject) => { const reader = new FileReader(); reader.onload = (e) => { const content = e.target.result; const pageData = {}; const sections = content.split(/^#\\s+/m).filter(s => s.trim()); const textRegex = /\\[TEXT\\s+title=\"([^\"]+)\"]([\\s\\S]*?)\\[\\/TEXT\\]/g; const videoRegex = /\\[VIDEO\\s+title=\"([^\"]+)\"](.*?)\\[\\/VIDEO\\]/g; for (const section of sections) { const lines = section.trim().split('\\n'); const pageNumber = parseInt(lines[0], 10); if (isNaN(pageNumber)) continue; let pageContent = lines.slice(1).join('\\n'); pageData[pageNumber] = []; let match; while ((match = textRegex.exec(pageContent)) !== null) { pageData[pageNumber].push({ type: 'text', title: match[1], content: match[2].trim() }); } while ((match = videoRegex.exec(pageContent)) !== null) { pageData[pageNumber].push({ type: 'video', title: match[1], url: match[2].trim() }); } } resolve(pageData); }; reader.onerror = () => reject(new Error('Error reading markdown file.')); reader.readAsText(file); }); } function updateSupplementalContent() { const contentDiv = document.getElementById('enhanced-pdf-viewer_supplemental-content'); const maximizedPanel = document.getElementById('enhanced-pdf-viewer_maximized-panel'); document.getElementById('enhanced-pdf-viewer_supplemental-container').style.display = hasSupplementalFile ? 'block' : 'none'; contentDiv.innerHTML = ''; maximizedPanel.innerHTML = ''; const pageItems = supplementalData[pageNum] || []; if (pageItems.length > 0) { pageItems.forEach(item => { const button = document.createElement('button'); button.className = 'enhanced-pdf-viewer__supplemental-button'; button.textContent = item.title; button.onclick = () => { if (item.type === 'video') { window.open(item.url, '_blank'); } else { openTextModal(item.title, item.content); } }; contentDiv.appendChild(button); const maximizedButton = document.createElement('button'); maximizedButton.className = 'enhanced-pdf-viewer__maximized-button'; maximizedButton.textContent = item.title; maximizedButton.onclick = () => { if (item.type === 'video') { window.open(item.url, '_blank'); } else { openTextModal(item.title, item.content); } }; maximizedPanel.appendChild(maximizedButton); }); } else { contentDiv.innerHTML = '<p>No supplemental information for page ' + pageNum + '.</p>'; } } function openTextModal(title, content) { document.getElementById('enhanced-pdf-viewer_text-modal-title').textContent = title; document.getElementById('enhanced-pdf-viewer_text-modal-content').textContent = content; document.getElementById('enhanced-pdf-viewer_text-modal').style.display = 'flex'; } function closeTextModal() { document.getElementById('enhanced-pdf-viewer_text-modal').style.display = 'none'; } function copyToClipboard(text) { navigator.clipboard.writeText(text).then(() => { alert('Copied to clipboard!'); }).catch(err => { console.error('Failed to copy:', err); alert('Failed to copy to clipboard'); }); } function renderPage(num) { pageRendering = true; document.getElementById('enhanced-pdf-viewer_loading').style.display = 'block'; updateSupplementalContent(); pdfDoc.getPage(num).then(page => { const viewport = page.getViewport({ scale: scale }); canvas.height = viewport.height; canvas.width = viewport.width; const renderTask = page.render({ canvasContext: ctx, viewport: viewport }); renderTask.promise.then(() => { pageRendering = false; document.getElementById('enhanced-pdf-viewer_loading').style.display = 'none'; if (pageNumPending !== null) { renderPage(pageNumPending); pageNumPending = null; } }); }); document.getElementById('enhanced-pdf-viewer_current-page').textContent = num; } function queueRenderPage(num) { if (pageRendering) { pageNumPending = num; } else { renderPage(num); } } function goPrevPage() { if (pageNum > 1) { pageNum--; queueRenderPage(pageNum); } } function goNextPage() { if (pageNum < pdfDoc.numPages) { pageNum++; queueRenderPage(pageNum); } } function handleMaximizedClick(event) { if (!isMaximized) return; const rect = event.target.getBoundingClientRect(); const x = event.clientX - rect.left; const width = rect.width; if (x < width / 2) { goPrevPage(); } else { goNextPage(); } } function toggleMaximize() { const pdfContainer = document.getElementById('enhanced-pdf-viewer_pdf-container'); const header = document.getElementById('enhanced-pdf-viewer_header'); const upload = document.getElementById('enhanced-pdf-viewer_upload'); const supplemental = document.getElementById('enhanced-pdf-viewer_supplemental-container'); const maximizedPanel = document.getElementById('enhanced-pdf-viewer_maximized-panel'); const maximizeBtn = document.getElementById('enhanced-pdf-viewer_maximize-button'); isMaximized = !isMaximized; if (isMaximized) { pdfContainer.classList.add('enhanced-pdf-viewer__maximized'); header.classList.add('enhanced-pdf-viewer__hidden'); upload.classList.add('enhanced-pdf-viewer__hidden'); supplemental.classList.add('enhanced-pdf-viewer__hidden'); maximizedPanel.style.display = hasSupplementalFile ? 'flex' : 'none'; maximizeBtn.textContent = 'Minimize'; } else { pdfContainer.classList.remove('enhanced-pdf-viewer__maximized'); header.classList.remove('enhanced-pdf-viewer__hidden'); upload.classList.remove('enhanced-pdf-viewer__hidden'); supplemental.classList.remove('enhanced-pdf-viewer__hidden'); maximizedPanel.style.display = 'none'; maximizeBtn.textContent = 'Maximize'; } } async function loadFiles() { const pdfInput = document.getElementById('enhanced-pdf-viewer_file-upload'); if (pdfInput.files.length === 0) { alert('Please select a PDF file.'); return; } pageNum = 1; hasSupplementalFile = false; supplementalData = {}; const supplementalInput = document.getElementById('enhanced-pdf-viewer_supplemental-upload'); if (supplementalInput.files.length > 0) { try { supplementalData = await parseMarkdownFile(supplementalInput.files[0]); hasSupplementalFile = true; } catch (error) { alert(error.message); } } const fileReader = new FileReader(); fileReader.onload = function() { pdfjsLib.getDocument(new Uint8Array(this.result)).promise.then(pdf => { pdfDoc = pdf; document.getElementById('enhanced-pdf-viewer_total-pages').textContent = pdfDoc.numPages; document.getElementById('enhanced-pdf-viewer_pdf-container').style.display = 'flex'; renderPage(pageNum); }).catch(err => { alert('Error loading PDF: ' + err.message); }); }; fileReader.readAsArrayBuffer(pdfInput.files[0]); } window[appNamespace].init = function() { console.log('Enhanced PDF Viewer app initialized'); initializePDFViewer(); document.getElementById('enhanced-pdf-viewer_upload-button').addEventListener('click', loadFiles); document.getElementById('enhanced-pdf-viewer_prev-page').addEventListener('click', goPrevPage); document.getElementById('enhanced-pdf-viewer_next-page').addEventListener('click', goNextPage); document.getElementById('enhanced-pdf-viewer_maximize-button').addEventListener('click', toggleMaximize); document.getElementById('enhanced-pdf-viewer_pdf-viewer').addEventListener('click', handleMaximizedClick); document.getElementById('enhanced-pdf-viewer_text-modal-close').addEventListener('click', closeTextModal); document.getElementById('enhanced-pdf-viewer_text-modal-copy').addEventListener('click', function() { const content = document.getElementById('enhanced-pdf-viewer_text-modal-content').textContent; copyToClipboard(content); }); document.getElementById('enhanced-pdf-viewer_text-modal').addEventListener('click', function(e) { if (e.target === this) closeTextModal(); }); if (typeof app !== 'undefined' && app.onKey) { app.onKey('keydown', function(event) { if (event.key === 'ArrowLeft') goPrevPage(); if (event.key === 'ArrowRight') goNextPage(); if (event.key === 'Escape') { if (document.getElementById('enhanced-pdf-viewer_text-modal').style.display === 'flex') { closeTextModal(); } else if (isMaximized) { toggleMaximize(); } } }); } };",
  "windowState": {
    "width": 800,
    "height": 600,
    "left": 100,
    "top": 100
  },
  "isMinimized": false,
  "isMaximized": false,
  "modificationHistory": [],
  "lastModification": null,
  "promptHistory": [],
  "isSystemApp": false,
  "isHidden": false,
  "generationMode": "SIMPLE",
  "hasImages": false,
  "imageCount": 0,
  "namespace": "app_enhanced_pdf_viewer",
  "exportDate": "2025-07-02T08:46:40.000Z",
  "exportedBy": "Self-Evolving OS v2.0.0",
  "version": "2.0",
  "compatibility": {
    "minVersion": "2.0.0",
    "features": [
      "namespace-isolation",
      "theme-support",
      "voice-modification",
      "prompt-history",
      "window-state-restoration"
    ]
  }
}